{{template "layout.tmpl" .}}

{{define "content"}}
<main>
    <div style="margin: 1rem 0" class="stack">
        <div class="big-avatar-wrapper">
            {{template "avatar.tmpl" (dict "User" .Session.User)}}
        </div>
        <h1 style="margin-top: 0">{{.User.Username}}</h1>

        {{if and .Session.IsLoggedIn (eq .Session.User.ID .User.ID)}}
        <a href="/settings" style="margin-left: auto;">Settings</a>
        {{end}}
    </div>

    <dl>
        <dt>Following</dt>
        <dd>{{.User.FollowingCount}}</dd>

        <dt>Followers</dt>
        <dd>{{.User.FollowersCount}}</dd>
    </dl>

    {{if and .Session.IsLoggedIn (ne .Session.User.ID .User.ID)}}
    {{template "user-follow-form.tmpl" .}}
    {{end}}

    <hr>

    <h2>{{.User.PostsCount}} Posts</h2>
    {{if eq (len .Posts) 0}}
    <p>No posts.</p>
    {{else}}
    <section style="display: flex; flex-direction: column; gap: 1rem;">
        {{range .Posts}}
        {{template "post.tmpl" (dict "Post" .)}}
        {{end}}
    </section>
    {{end}}
</main>
{{end}}
