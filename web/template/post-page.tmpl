{{template "layout.tmpl" .}}

{{define "content"}}
<main>
    {{template "post.tmpl" .Post}}

    <h2>Comments</h2>

    {{if eq (len .Comments) 0}}
    <p>No comments yet.</p>
    {{else}}
    <section style="display: flex; flex-direction: column; gap: 1rem;">
        {{range .Comments}}
        {{template "comment.tmpl" .}}
        {{end}}
    </section>
    {{end}}

    {{if .Session.IsLoggedIn}}
    <br>
    <form action="/comments" method="POST">
        <input type="hidden" name="post_id" value="{{.Post.ID}}">

        <textarea name="content" aria-label="content" placeholder="Write something..." rows="3" maxlength="1000"
            required>
            {{- .CreateCommentForm.Get "content" -}}
        </textarea>

        {{if .CreateCommentErr}}
        <p>Could not create comment: <code>{{.CreateCommentErr}}</code></p>
        {{end}}

        <button>Comment</button>
    </form>
    {{end}}
</main>
{{end}}
