{{template "layout.tmpl" .}}

{{define "content"}}
<main>
    {{template "post.tmpl" (dict "Post" .Post "PostMedia" .PostMedia)}}

    <h2>Comments</h2>

    {{if eq (len .Comments) 0}}
    <p>No comments yet.</p>
    {{else}}
    <section style="display: flex; flex-direction: column; gap: 1rem;">
        {{range .Comments}}
        {{template "comment.tmpl" .}}
        {{end}}
    </section>
    {{end}}

    {{if .Session.IsLoggedIn}}
    <br>
    <form action="/comments" method="POST">
        <input type="hidden" name="post_id" value="{{.Post.ID}}">

        <textarea name="content" aria-label="content" placeholder="Write something..." rows="3" maxlength="1000"
            required>
            {{- .CreateCommentForm.Get "content" -}}
        </textarea>

        {{if .CreateCommentErr}}
        <p>Could not create comment: <code>{{.CreateCommentErr}}</code></p>
        {{end}}

        <button class="v-stack">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                stroke="currentColor" class="w-6 h-6">
                <path stroke-linecap="round" stroke-linejoin="round"
                    d="M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5" />
            </svg>
            <span>Comment</span>
        </button>
    </form>
    {{end}}
</main>
{{end}}
